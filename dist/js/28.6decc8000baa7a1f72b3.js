webpackJsonp([28],{1302:function(t,e,n){var r=n(626)(n(1392),n(1404),null,null);t.exports=r.exports},1392:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(169),s=n.n(r),a=n(168),i=n.n(a),o=n(320);e.default={name:"admin-journeys-list",data:function(){return{journeys:[]}},computed:{config:function(){return{refresh:!1,columnPicker:!0,responsive:!0,pagination:{rowsPerPage:20,options:[5,10,15,20,30,50]},messages:{noData:this.$t("table_no_data"),noDataAfterFiltering:this.$t("table_no_data_after_filtering")},labels:{columns:this.$t("columns"),allCols:this.$t("all_columns"),rows:this.$t("rows"),selected:{singular:this.$t("selected_singular"),plural:this.$t("selected_plural")},clear:this.$t("clear"),search:this.$t("search"),all:this.$t("all")}}},items:function(){return this.journeys},columns:function(){return[{label:this.$t("published"),field:"published",sort:!0,filter:!0,width:"100px"},{label:this.$t("language"),field:"lang",sort:!0,filter:!0},{label:this.$t("title"),field:"title",sort:!0,filter:!0},{label:this.$t("start_date"),field:"startDate",sort:!0,filter:!0,format:function(t,e){return new Date(t).toLocaleDateString()}},{label:this.$t("end_date"),field:"endDate",sort:!0,filter:!0,format:function(t,e){return new Date(t).toLocaleDateString()}},{label:"",field:"actions",width:"100px",classes:"text-right"}]}},methods:{confirmTogglePublish:function(t,e){this.$root.$publishDialog(t.row.title,t,e,this.togglePublish)},togglePublish:function(t,e){var n=this;return i()(s.a.mark(function r(){var a,i;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a();case 2:return a=n.sent,n.next=5,a.journey.findById(t.row._id);case 5:return i=n.sent,i.published=e,n.next=9,i.save();case 9:case"end":return n.stop()}},r,n)}))()},confirmDelete:function(t){this.$root.$deleteDialog(t.row.title,t,this.deleteItem)},deleteItem:function(t){var e=this;return i()(s.a.mark(function n(){var r,a,l;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a();case 2:return r=n.sent,n.next=5,r.journey.findById(t.row._id);case 5:return a=n.sent,n.next=8,a.locations_;case 8:l=n.sent,l.forEach(function(){var t=i()(s.a.mark(function t(n){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.remove();case 2:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}()),a.remove().then(function(){e.$root.$toastSuccess(e.$t("delete_item_successfully"))}).catch(function(t){e.$root.$toastError(t.message)});case 11:case"end":return n.stop()}},n,e)}))()}},mounted:function(){var t=this;return i()(s.a.mark(function e(){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a();case 2:n=e.sent,n.journey.find().$.subscribe(function(e){t.journeys=e});case 4:case"end":return e.stop()}},e,t)}))()}}},1404:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[n("div",{staticClass:"toolbar"},[n("i",[t._v("terrain")]),t._v(" "),n("q-toolbar-title",{attrs:{padding:1}},[t._v(t._s(t.$t("journeys_list")))]),t._v(" "),n("router-link",{staticClass:"primary",attrs:{tag:"button",to:{name:"admin_journeys_detail"}}},[n("i",[t._v("add")]),t._v(" "+t._s(t.$t("journey_add"))+"\n        ")])],1),t._v(" "),n("div",{staticClass:"card-content"},[n("q-data-table",{staticClass:"no-border",attrs:{data:t.items,config:t.config,columns:t.columns},scopedSlots:t._u([["col-published",function(e){return[n("q-toggle",{staticClass:"primary",attrs:{value:e.data},on:{input:function(n){t.confirmTogglePublish(e,n)}}})]}],["col-actions",function(e){return[n("router-link",{staticClass:"primary small",attrs:{tag:"button",to:{name:"admin_journeys_detail",params:{journey:e.row._id}}}},[n("i",[t._v("edit")]),t._v(" "),n("q-tooltip",[t._v(t._s(t.$t("detail_view")))])],1),t._v(" "),n("button",{staticClass:"negative small",on:{click:function(n){n.preventDefault(),t.confirmDelete(e)}}},[n("i",[t._v("delete_forever")]),t._v(" "),n("q-tooltip",[t._v(t._s(t.$t("delete_item")))])],1)]}]])})],1)])},staticRenderFns:[]}}});